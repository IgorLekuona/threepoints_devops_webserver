name: ci

on:
  push
    # branches:
    #   - 'master'

jobs:
  docker:
      runs-on: ubuntu-latest
      steps:
        -
          name: Check source branch
          if: github.ref != 'master' || !(contains(github.ref, 'feature')) || !(contains(github.ref, 'hotfix'))
          run: exit -1
        -
          name: Pruebas de SAST
          run: echo 'Ejecución de pruebas de SAST'
        -
          name: Creación de credenciales
          uses: "DamianReeves/write-file-action@master"
          with:
            path: ./.config/credentials.ini
            write-mode: overwrite
            contents: |
              USERNAME = ${{ secrets.USERNAME }} , PASSWORD = ${{ secrets.PASSWORD }}
        -
          uses: actions/checkout@v3
        -
          name: Build docker image
          working-directory: .
          run: docker build --file Dockerfile -t devops_ws .
          # uses: docker/build-push-action@v5
          # with:
          #   context: .
          #   file: Dockerfile
          #   push: true
          #   tags: myimage:latest
          #   outputs: type=docker,dest=/tmp/myimage.tar